<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ìˆ˜ê°•ì‹ ì²­ (êµ­/ìˆ˜)</title>
  </head>
  <body>
    <div>
      <button id="btnKor">êµ­ì–´ ìˆ˜ì—… ìš”ì¼ì„ íƒ ></button>
      <label id="kor">ìš”ì¼ì„ ì„ íƒí•˜ì„¸ìš”!</label>
    </div>
    <div>
      <button id="btnMath" onclick="throttleSetWeek()">
        ìˆ˜í•™ ìˆ˜ì—… ìš”ì¼ì„ íƒ >
      </button>
      <label id="math">ìš”ì¼ì„ ì„ íƒí•˜ì„¸ìš”!</label>
    </div>

    <div>
      <input id="searchInput" onchange="searchKeyword()" />
      <div id="searchRes"></div>
    </div>

    <script>
      const weeks = "ì¼ì›”í™”ìˆ˜ëª©ê¸ˆí† ";

      // ë””ë°”ìš´ìŠ¤ & ì“°ë¡œí‹€ë§ (í‰ê°€ë¬¸ì œ)
      const debounce = (cb, delay) => {
        let timer;
        return (...args) => {
          if (timer) clearTimeout(timer);
          timer = setTimeout(cb, delay, ...args);
        }
      }

      const throttle = (cb, delay) => {
        let timer;
        return (...args) => {
          if (timer) return; // timerê°€ ë„ëŠ” ë™ì•ˆì€ ì´ë²¤íŠ¸ ë¬´ì‹œ
          timer = setTimeout(() => {
            cb(...args);
            timer = null;
          }, delay);
        }
      }

      const searchKeyword = throttle(() => {
        const keyword = document.getElementById("searchInput").value
        console.log("ğŸš€ ~ searchKeyword ~ keyword:", keyword)
        document.getElementById("searchRes").innerText = keyword
      }, 500);

      const getNextWeek = () => {
        let widx = -1;
        return () => {
          widx += 1;
          if (widx >= weeks.length) widx = 0;
          return `${weeks[widx]}ìš”ì¼`;
        };
      };

      <!-- const korWeek = getNextWeek();
      const mathWeek = getNextWeek(); -->

      const nextWeekFunction = {
        kor: getNextWeek(),
        math: getNextWeek(),
      };

      const setWeek = (subject) => {
        console.log("setWeek!");
        const nextWeekFn = subject === "math" ? mathWeek : korWeek;
        document.getElementById(subject).innerText =
          nextWeekFunction[subject]();
      };

      const throttleSetWeek = throttle(setWeek, 500);

      window.addEventListener("load", () => {
        const fn = debounce(() => {
          console.log("setWeek!");
        }, 200);
        document.getElementById("btnKor").addEventListener("click", fn);
        console.log("loaded!");
      });

      // test code
      let runCnt = 0;
      const subjects = ['kor', 'math'];
      const intl = setInterval(() =>{
        runCnt += 1;
        if (runCnt > 20) clearInterval(intl);
        document.getElementById(subjects[subjects % 2]).click();
      }, 200);
    </script>
  </body>
</html>
